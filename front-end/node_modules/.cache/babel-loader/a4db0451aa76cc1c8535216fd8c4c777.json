{"remainingRequest":"D:\\projectFPT\\SolidityProject\\front-end\\node_modules\\babel-loader\\lib\\index.js!D:\\projectFPT\\SolidityProject\\front-end\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\projectFPT\\SolidityProject\\front-end\\src\\services\\http.js","dependencies":[{"path":"D:\\projectFPT\\SolidityProject\\front-end\\src\\services\\http.js","mtime":1634524960286},{"path":"D:\\projectFPT\\SolidityProject\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\projectFPT\\SolidityProject\\front-end\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\projectFPT\\SolidityProject\\front-end\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiRDovcHJvamVjdEZQVC9Tb2xpZGl0eVByb2plY3QvZnJvbnQtZW5kL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiRDovcHJvamVjdEZQVC9Tb2xpZGl0eVByb2plY3QvZnJvbnQtZW5kL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCB7IEF1dGhTZXJ2aWNlIH0gZnJvbSAnQC9zZXJ2aWNlcy9hdXRoLmpzJzsKaW1wb3J0IHsgQVBJX1VSTCB9IGZyb20gJy4uLy5lbnYnOwpleHBvcnQgdmFyIEh0dHAgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEh0dHAoc3RhdHVzKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSHR0cCk7CgogICAgdGhpcy5pc0F1dGggPSBzdGF0dXMgJiYgc3RhdHVzLmF1dGggPyBzdGF0dXMuYXV0aCA6IGZhbHNlOwogICAgdGhpcy5pbnN0YW5jZSA9IGF4aW9zLmNyZWF0ZSh7CiAgICAgIGJhc2VVUkw6IEFQSV9VUkwKICAgIH0pOwogICAgcmV0dXJuIHRoaXMuaW5pdCgpOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEh0dHAsIFt7CiAgICBrZXk6ICJpbml0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0KCkgewogICAgICBpZiAodGhpcy5pc0F1dGgpIHsKICAgICAgICB0aGlzLmluc3RhbmNlLmludGVyY2VwdG9ycy5yZXF1ZXN0LnVzZShmdW5jdGlvbiAocmVxdWVzdCkgewogICAgICAgICAgcmVxdWVzdC5oZWFkZXJzLmF1dGhvcml6YXRpb24gPSBBdXRoU2VydmljZS5nZXRCZWFyZXIoKTsgLy8gTuG6v3UgYWNjZXNzIHRva2VuIGjhur90IGjhuqFuIHbDoCByZWZyZXNoVG9rZW4gdOG7k24gdOG6oWkgPj4gdOG7m2kgQVBJIHbDoCBs4bqleSBhY2Nlc3MgdG9rZW4gbeG7m2kKCiAgICAgICAgICBpZiAoQXV0aFNlcnZpY2UuaXNBY2Nlc3NUb2tlbkV4cGlyZWQoKSAmJiBBdXRoU2VydmljZS5oYXNSZWZyZXNoVG9rZW4oKSkgewogICAgICAgICAgICByZXR1cm4gQXV0aFNlcnZpY2UuZGVib3VuY2VSZWZyZXNoVG9rZW5zKCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICBBdXRoU2VydmljZS5zZXRCZWFyZXIocmVzcG9uc2UuZGF0YS5hY2Nlc3NUb2tlbik7CiAgICAgICAgICAgICAgcmVxdWVzdC5oZWFkZXJzLmF1dGhvcml6YXRpb24gPSBBdXRoU2VydmljZS5nZXRCZWFyZXIoKTsKICAgICAgICAgICAgICByZXR1cm4gcmVxdWVzdDsKICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gcmVxdWVzdDsKICAgICAgICAgIH0KICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLmluc3RhbmNlOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEh0dHA7Cn0oKTs="},{"version":3,"sources":["D:/projectFPT/SolidityProject/front-end/src/services/http.js"],"names":["axios","AuthService","API_URL","Http","status","isAuth","auth","instance","create","baseURL","init","interceptors","request","use","headers","authorization","getBearer","isAccessTokenExpired","hasRefreshToken","debounceRefreshTokens","then","response","setBearer","data","accessToken","catch","error","Promise","reject"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAEA,SAASC,WAAT,QAA4B,oBAA5B;AACA,SAASC,OAAT,QAAwB,SAAxB;AAEA,WAAaC,IAAb;AACE,gBAAaC,MAAb,EAAqB;AAAA;;AACnB,SAAKC,MAAL,GAAcD,MAAM,IAAIA,MAAM,CAACE,IAAjB,GAAwBF,MAAM,CAACE,IAA/B,GAAsC,KAApD;AACA,SAAKC,QAAL,GAAgBP,KAAK,CAACQ,MAAN,CAAa;AAC3BC,MAAAA,OAAO,EAAEP;AADkB,KAAb,CAAhB;AAGA,WAAO,KAAKQ,IAAL,EAAP;AACD;;AAPH;AAAA;AAAA,2BASU;AACN,UAAI,KAAKL,MAAT,EAAiB;AACf,aAAKE,QAAL,CAAcI,YAAd,CAA2BC,OAA3B,CAAmCC,GAAnC,CAAuC,UAAAD,OAAO,EAAI;AAChDA,UAAAA,OAAO,CAACE,OAAR,CAAgBC,aAAhB,GAAgCd,WAAW,CAACe,SAAZ,EAAhC,CADgD,CAEhD;;AACA,cAAIf,WAAW,CAACgB,oBAAZ,MAAsChB,WAAW,CAACiB,eAAZ,EAA1C,EAAyE;AACvE,mBAAOjB,WAAW,CAACkB,qBAAZ,GACJC,IADI,CACC,UAAAC,QAAQ,EAAI;AAChBpB,cAAAA,WAAW,CAACqB,SAAZ,CAAsBD,QAAQ,CAACE,IAAT,CAAcC,WAApC;AACAZ,cAAAA,OAAO,CAACE,OAAR,CAAgBC,aAAhB,GAAgCd,WAAW,CAACe,SAAZ,EAAhC;AACA,qBAAOJ,OAAP;AACD,aALI,EAKFa,KALE,CAKI,UAAAC,KAAK;AAAA,qBAAIC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAJ;AAAA,aALT,CAAP;AAMD,WAPD,MAOO;AACL,mBAAOd,OAAP;AACD;AACF,SAbD,EAaG,UAAAc,KAAK,EAAI;AACV,iBAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACD,SAfD;AAgBD;;AAED,aAAO,KAAKnB,QAAZ;AACD;AA9BH;;AAAA;AAAA","sourcesContent":["import axios from 'axios'\r\n\r\nimport { AuthService } from '@/services/auth.js'\r\nimport { API_URL } from '../.env'\r\n\r\nexport class Http {\r\n  constructor (status) {\r\n    this.isAuth = status && status.auth ? status.auth : false\r\n    this.instance = axios.create({\r\n      baseURL: API_URL\r\n    })\r\n    return this.init()\r\n  }\r\n\r\n  init () {\r\n    if (this.isAuth) {\r\n      this.instance.interceptors.request.use(request => {\r\n        request.headers.authorization = AuthService.getBearer()\r\n        // Nếu access token hết hạn và refreshToken tồn tại >> tới API và lấy access token mới\r\n        if (AuthService.isAccessTokenExpired() && AuthService.hasRefreshToken()) {\r\n          return AuthService.debounceRefreshTokens()\r\n            .then(response => {\r\n              AuthService.setBearer(response.data.accessToken)\r\n              request.headers.authorization = AuthService.getBearer()\r\n              return request\r\n            }).catch(error => Promise.reject(error))\r\n        } else {\r\n          return request\r\n        }\r\n      }, error => {\r\n        return Promise.reject(error)\r\n      })\r\n    }\r\n\r\n    return this.instance\r\n  }\r\n}"]}]}